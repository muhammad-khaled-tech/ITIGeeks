import{l as P,r as i,j as e,d as s}from"./vendor-react.06bced68.js";import{N as v,z as w,d as $,a0 as k,$ as L,h as S}from"./index.17f04fdd.js";import{l as j,_ as C}from"./vendor-firebase.bbe5d1cc.js";import"./vendor-ui.c6987468.js";const G=()=>{const{isDark:t}=P()||{isDark:!0},[d,h]=i.exports.useState({students:0,contests:0,solved:0}),[m,x]=i.exports.useState([]),[n,A]=i.exports.useState([]),[D,F]=i.exports.useState(!0);return i.exports.useEffect(()=>{(async()=>{var l,c,p,b;try{const y=(await j(C(S,"users"))).docs.map(r=>({id:r.id,...r.data()})),T=(await j(C(S,"contests"))).docs.filter(r=>{const o=r.data();return new Date(o.endTime)>new Date});let N=0;const g=y.map(r=>{const o=(r.problems||[]).filter(U=>U.status==="Done").length;return N+=o,{...r,solved:o}}).sort((r,o)=>o.solved-r.solved).slice(0,5);h({students:y.length,contests:T.length,solved:N}),x(g),A([{id:1,type:"solve",user:((l=g[0])==null?void 0:l.displayName)||((c=g[0])==null?void 0:c.leetcodeUsername)||((b=(p=g[0])==null?void 0:p.email)==null?void 0:b.split("@")[0])||"User",action:"solved Two Sum",time:"2 min ago"},{id:2,type:"join",user:"New Student",action:"joined Group A",time:"15 min ago"},{id:3,type:"contest",user:"System",action:'Contest "Weekly #5" started',time:"1 hour ago"}])}catch(f){console.error("Dashboard fetch error:",f)}finally{F(!1)}})()},[]),D?e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-brand border-t-transparent"})}):s("div",{className:"space-y-6",children:[s("div",{children:[e("h1",{className:`text-2xl font-bold ${t?"text-leet-text":"text-gray-900"}`,children:"Dashboard"}),e("p",{className:t?"text-leet-sub":"text-gray-500",children:"Welcome back! Here's what's happening."})]}),s("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e(u,{isDark:t,title:"Total Students",value:d.students,icon:e(v,{className:"text-blue-500"}),trend:"+12%",trendUp:!0}),e(u,{isDark:t,title:"Active Contests",value:d.contests,icon:e(w,{className:"text-yellow-500"}),trend:"2 ending today",trendUp:null}),e(u,{isDark:t,title:"Problems Solved",value:d.solved.toLocaleString(),icon:e($,{className:"text-green-500"}),trend:"+8%",trendUp:!0})]}),s("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e("div",{className:"lg:col-span-2",children:s("div",{className:`rounded-lg p-6 ${t?"bg-leet-card border border-leet-border":"bg-white shadow"}`,children:[e("h3",{className:`text-lg font-semibold mb-4 ${t?"text-leet-text":"text-gray-900"}`,children:"Recent Activity"}),e("div",{className:"space-y-4",children:n.map(a=>s("div",{className:`flex items-center gap-4 p-3 rounded-lg ${t?"bg-leet-input":"bg-gray-50"}`,children:[s("div",{className:"w-10 h-10 bg-brand/10 rounded-full flex items-center justify-center",children:[a.type==="solve"&&e($,{className:"text-green-500"}),a.type==="join"&&e(v,{className:"text-blue-500"}),a.type==="contest"&&e(w,{className:"text-yellow-500"})]}),s("div",{className:"flex-1",children:[s("p",{className:`text-sm ${t?"text-leet-text":"text-gray-900"}`,children:[e("span",{className:"font-medium",children:a.user})," ",a.action]}),e("p",{className:`text-xs ${t?"text-leet-sub":"text-gray-500"}`,children:a.time})]})]},a.id))})]})}),e("div",{children:s("div",{className:`rounded-lg p-6 ${t?"bg-leet-card border border-leet-border":"bg-white shadow"}`,children:[e("h3",{className:`text-lg font-semibold mb-4 ${t?"text-leet-text":"text-gray-900"}`,children:"\u{1F3C6} Top Performers"}),s("div",{className:"space-y-3",children:[m.map((a,l)=>{var c;return s("div",{className:`flex items-center gap-3 p-2 rounded-lg transition-colors ${t?"hover:bg-leet-input":"hover:bg-gray-50"}`,children:[e("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold
                                        ${l===0?"bg-yellow-100 text-yellow-700":l===1?"bg-gray-100 text-gray-700":l===2?"bg-orange-100 text-orange-700":t?"bg-leet-input text-leet-sub":"bg-gray-50 text-gray-500"}`,children:l+1}),e("div",{className:"flex-1 min-w-0",children:e("p",{className:`text-sm font-medium truncate ${t?"text-leet-text":"text-gray-900"}`,children:a.displayName||a.leetcodeUsername||((c=a.email)==null?void 0:c.split("@")[0])||"Anonymous"})}),e("span",{className:"text-sm font-bold text-brand",children:a.solved})]},a.id)}),m.length===0&&e("p",{className:`text-sm text-center py-4 ${t?"text-leet-sub":"text-gray-500"}`,children:"No students yet"})]})]})})]}),s("div",{className:`rounded-lg p-6 ${t?"bg-leet-card border border-leet-border":"bg-white shadow"}`,children:[e("h3",{className:`text-lg font-semibold mb-4 ${t?"text-leet-text":"text-gray-900"}`,children:"Quick Actions"}),s("div",{className:"flex flex-wrap gap-3",children:[e("a",{href:"/admin/contests",className:"px-4 py-2 bg-brand hover:bg-brand-hover text-white rounded-lg text-sm font-medium transition-colors",children:"+ Create Contest"}),e("a",{href:"/admin/assignments",className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium transition-colors",children:"+ Create Assignment"}),e("a",{href:"/admin/students",className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t?"bg-leet-input hover:bg-leet-border text-leet-text":"bg-gray-200 hover:bg-gray-300 text-gray-800"}`,children:"Manage Students"})]})]})]})},u=({isDark:t,title:d,value:h,icon:m,trend:x,trendUp:n})=>e("div",{className:`rounded-lg p-6 transition-shadow hover:shadow-xl ${t?"bg-leet-card border border-leet-border":"bg-white shadow-lg"}`,children:s("div",{className:"flex items-start justify-between",children:[s("div",{children:[e("p",{className:`text-sm font-medium ${t?"text-leet-sub":"text-gray-500"}`,children:d}),e("p",{className:`text-3xl font-bold mt-2 ${t?"text-leet-text":"text-gray-900"}`,children:h}),x&&s("p",{className:`text-sm mt-2 flex items-center gap-1 ${n===!0?"text-green-500":n===!1?"text-red-500":t?"text-leet-sub":"text-gray-500"}`,children:[n===!0&&e(k,{className:"text-xs"}),n===!1&&e(L,{className:"text-xs"}),x]})]}),e("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center text-xl ${t?"bg-leet-input":"bg-gray-100"}`,children:m})]})});export{G as default};
