import{r as c,d as a,j as e,i as T}from"./vendor-react.06bced68.js";import{E as w,h as u,z as E,u as L,P as N,R as C,p as P,d as j}from"./index.17f04fdd.js";import{R as k,_ as v,I as D,b as S,a as I,k as R,l as A}from"./vendor-firebase.bbe5d1cc.js";import{B as F}from"./Breadcrumbs.63a79896.js";import{B as $}from"./Badge.32afea85.js";import"./vendor-ui.c6987468.js";const B=({contestId:i})=>{const[x,p]=c.exports.useState([]);c.exports.useEffect(()=>{if(!i)return;const r=k(v(u,"contests",i,"submissions"));return D(r,async f=>{const y=f.docs.map(t=>t.data()),s={},o=new Set;y.forEach(t=>{if(o.add(t.userId),s[t.userId]||(s[t.userId]={userId:t.userId,username:t.username,totalScore:0,problemsSolved:new Set,lastSubmissionTime:0}),!s[t.userId].problemsSolved.has(t.problemSlug)){s[t.userId].problemsSolved.add(t.problemSlug),s[t.userId].totalScore+=t.score;const n=new Date(t.timestamp).getTime();n>s[t.userId].lastSubmissionTime&&(s[t.userId].lastSubmissionTime=n)}});const l={};await Promise.all(Array.from(o).map(async t=>{const n=await S(I(u,"users",t));n.exists()&&(l[t]=n.data().badges||[])}));const h=Object.values(s).sort((t,n)=>n.totalScore!==t.totalScore?n.totalScore-t.totalScore:t.lastSubmissionTime-n.lastSubmissionTime).map(t=>({...t,badges:l[t.userId]||[]}));p(h)})},[i]);const d=r=>r===0?"bg-yellow-100 dark:bg-yellow-900/30 border-l-4 border-yellow-400":r===1?"bg-gray-100 dark:bg-gray-800/50 border-l-4 border-gray-400":r===2?"bg-orange-100 dark:bg-orange-900/30 border-l-4 border-orange-400":"hover:bg-gray-50 dark:hover:bg-leet-input border-l-4 border-transparent",b=r=>r===0?e(E,{className:"text-yellow-500 text-xl"}):r===1?e(w,{className:"text-gray-400 text-lg"}):r===2?e(w,{className:"text-orange-500 text-lg"}):a("span",{className:"font-mono font-bold text-gray-500 dark:text-gray-400",children:["#",r+1]});return a("div",{className:"bg-white dark:bg-leet-card rounded-lg shadow overflow-hidden",children:[e("div",{className:"bg-brand px-4 py-3 border-b border-brand-dark",children:a("h3",{className:"text-white font-bold flex items-center gap-2",children:[e(w,{})," Live Leaderboard"]})}),e("div",{className:"overflow-x-auto",children:a("table",{className:"min-w-full text-sm",children:[e("thead",{className:"bg-gray-50 dark:bg-leet-input",children:a("tr",{children:[e("th",{className:"px-4 py-2 text-left dark:text-gray-300 w-16",children:"Rank"}),e("th",{className:"px-4 py-2 text-left dark:text-gray-300",children:"User"}),e("th",{className:"px-4 py-2 text-right dark:text-gray-300",children:"Solved"}),e("th",{className:"px-4 py-2 text-right dark:text-gray-300",children:"Score"})]})}),a("tbody",{className:"divide-y divide-gray-200 dark:divide-leet-border",children:[x.map((r,g)=>a("tr",{className:`transition duration-150 ${d(g)}`,children:[e("td",{className:"px-4 py-3 flex items-center justify-center",children:b(g)}),e("td",{className:"px-4 py-3",children:a("div",{className:"flex items-center gap-2",children:[e("span",{className:"font-bold dark:text-white",children:r.username}),r.badges.length>0&&e("div",{className:"scale-75 origin-left",children:e($,{name:r.badges[r.badges.length-1],size:"sm"})})]})}),e("td",{className:"px-4 py-3 text-right dark:text-gray-400 font-mono",children:r.problemsSolved.size}),e("td",{className:"px-4 py-3 text-right font-bold text-brand dark:text-brand-dark text-lg",children:r.totalScore})]},r.userId)),x.length===0&&e("tr",{children:e("td",{colSpan:"4",className:"text-center py-4 text-gray-500",children:"No submissions yet."})})]})]})})]})};var M=B;function W(){const{contestId:i}=T(),{userData:x,currentUser:p}=L(),[d,b]=c.exports.useState(null),[r,g]=c.exports.useState("");c.exports.useState(null);const[f,y]=c.exports.useState(new Set);return c.exports.useEffect(()=>{(async()=>{const o=I(u,"contests",i),l=await S(o);l.exists()&&b({id:l.id,...l.data()})})()},[i]),c.exports.useEffect(()=>{(async()=>{if(!p)return;const o=k(v(u,"contests",i,"submissions"),R("userId","==",p.uid)),l=await A(o),m=new Set(l.docs.map(h=>h.data().problemSlug));y(m)})()},[i,p]),c.exports.useEffect(()=>{if(!d)return;const s=setInterval(()=>{const o=new Date().getTime(),m=new Date(d.endTime).getTime()-o;if(m<0)g("ENDED"),clearInterval(s);else{const h=Math.floor(m%864e5/36e5),t=Math.floor(m%(1e3*60*60)/(1e3*60)),n=Math.floor(m%(1e3*60)/1e3);g(`${h}h ${t}m ${n}s`)}},1e3);return()=>clearInterval(s)},[d]),d?a("div",{className:"max-w-6xl mx-auto p-4 pb-20",children:[e(F,{customLastLabel:d.title}),a("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a("div",{className:"lg:col-span-2 space-y-6",children:[e("div",{className:"bg-white dark:bg-leet-card rounded-2xl shadow-xl p-6 md:p-8 border-l-8 border-brand",children:a("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[a("div",{children:[e("h1",{className:"text-3xl font-black italic dark:text-white uppercase tracking-tight",children:d.title}),e("p",{className:"text-gray-500 dark:text-gray-400 text-xs font-bold mt-1 uppercase tracking-widest",children:"Contest Arena"})]}),a("div",{className:"text-xl font-mono font-black bg-gray-100 dark:bg-leet-input px-6 py-3 rounded-xl flex items-center gap-3 dark:text-white shadow-inner",children:[e(N,{className:r==="ENDED"?"text-red-500":"text-green-500 animate-pulse"}),r]})]})}),a("div",{className:"bg-white dark:bg-leet-card rounded-lg shadow overflow-hidden",children:[a("div",{className:"px-6 py-4 border-b dark:border-leet-border bg-yellow-50 dark:bg-yellow-900/10 flex items-center gap-2",children:[e(C,{className:"text-yellow-600 animate-pulse"}),a("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e("strong",{children:"To Verify Solved Problems:"})," Click the ",e("strong",{children:"Sync"})," button in the top Navbar after solving on LeetCode."]})]}),a("table",{className:"min-w-full",children:[e("thead",{className:"bg-gray-50 dark:bg-leet-input",children:a("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Problem"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Points"}),e("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"})]})}),e("tbody",{className:"divide-y divide-gray-200 dark:divide-leet-border",children:d.problems.map((s,o)=>{const l=f.has(s.slug);return a("tr",{className:l?"bg-green-50 dark:bg-green-900/20":"",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("a",{href:`https://leetcode.com/problems/${s.slug}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-brand hover:bg-brand-hover text-white px-4 py-2 rounded-lg text-xs font-black uppercase tracking-widest shadow-lg shadow-brand/20 transition-all hover:scale-105 active:scale-95",children:["Solve ",e(P,{size:10})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold dark:text-white",children:s.score}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:l?a("span",{className:"text-green-600 font-bold flex items-center justify-end gap-1",children:[e(j,{})," Solved"]}):a("span",{className:"text-gray-400 font-medium flex items-center justify-end gap-1",children:[e(N,{})," Pending"]})})]},o)})})]})]})]}),e("div",{className:"lg:col-span-1",children:e(M,{contestId:d.id})})]})]}):e("div",{className:"p-6",children:"Loading Arena..."})}export{W as default};
