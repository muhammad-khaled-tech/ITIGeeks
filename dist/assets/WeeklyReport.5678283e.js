import{r as s,d as r,j as e}from"./vendor-react.06bced68.js";import{g as m,f as h,b as g,ab as b}from"./index.17f04fdd.js";import"./vendor-firebase.bbe5d1cc.js";import"./vendor-ui.c6987468.js";const y=()=>{const[a,d]=s.exports.useState(!1),[n,i]=s.exports.useState(null),[l,o]=s.exports.useState(null);return r("div",{className:"p-6",children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Weekly Report Control"}),r("div",{className:"bg-white dark:bg-leet-card rounded-lg shadow p-6 max-w-2xl",children:[r("div",{className:"flex items-start gap-4 mb-6",children:[e("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-600 dark:text-blue-400",children:e(m,{className:"text-xl"})}),r("div",{children:[e("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Manual Trigger"}),e("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:'This will trigger the "Top G" calculation and send emails to all registered students via Resend.'})]})]}),e("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4 mb-6",children:r("div",{className:"flex",children:[e(h,{className:"text-yellow-400 mt-1 mr-3"}),e("div",{children:r("p",{className:"text-sm text-yellow-700 dark:text-yellow-200",children:[e("strong",{children:"Warning:"})," This action sends ",e("strong",{children:"real emails"}),". Ensure you have verified the data logic before clicking."]})})]})}),e("button",{onClick:async()=>{if(!!confirm("Are you sure? This will send REAL emails to all students!")){d(!0),o(null),i(null);try{const t=await fetch("/api/cron/weekly-report",{method:"GET",headers:{}}),c=await t.json();if(!t.ok)throw new Error(c.error||"Failed to send report");i(c)}catch(t){console.error(t),o(t.message)}finally{d(!1)}}},disabled:a,className:`w-full flex justify-center items-center gap-2 px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white 
                        ${a?"bg-gray-400":"bg-brand hover:bg-brand-hover"} transition-colors focus:outline-none`,children:a?e(g,{className:"animate-spin"}):"Send Weekly Report Now"}),r("div",{className:"mt-6",children:[n&&r("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-md border border-green-200 dark:border-green-800 text-green-700 dark:text-green-300 flex items-center gap-3",children:[e(b,{}),r("div",{children:[e("p",{className:"font-bold",children:"Success!"}),e("p",{className:"text-sm",children:JSON.stringify(n)})]})]}),l&&r("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-md border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300",children:[e("p",{className:"font-bold",children:"Error:"}),e("p",{className:"text-sm",children:l}),l.includes("Missing API Key")&&e("p",{className:"text-xs mt-2",children:"Make sure RESEND_API_KEY is set in Vercel Environment Variables."})]})]})]})]})};export{y as default};
