import{r as l,d as a,j as e,F as j}from"./vendor-react.06bced68.js";import{u as M,X as $,Y as O,f as Y,z as D,R as V,Z as W,_,b as q,$ as R,a0 as T,B as d,a1 as z}from"./index.17f04fdd.js";import{B as H}from"./Breadcrumbs.63a79896.js";import"./vendor-firebase.bbe5d1cc.js";import"./vendor-ui.c6987468.js";const U=[{id:"all",label:"All Time"},{id:"month",label:"This Month"},{id:"week",label:"This Week"}],ee=()=>{const{userData:h,currentUser:n}=M(),[A,v]=l.exports.useState([]),[u,b]=l.exports.useState(!0),[y,w]=l.exports.useState(!1),[m,g]=l.exports.useState(null),[f,B]=l.exports.useState("all"),[r,S]=l.exports.useState("overall"),[c,F]=l.exports.useState("totalPoints"),[p,N]=l.exports.useState("desc"),o=h==null?void 0:h.groupId;l.exports.useEffect(()=>{o?P():h!==null&&b(!1)},[o,f,r,h]),l.exports.useEffect(()=>{F(r==="overall"?"totalPoints":"contestPoints"),N("desc")},[r]);const P=async()=>{var t,i;try{b(!0),g(null);const s=r==="overall"?await $(o,f):await O(o);v(s)}catch(s){console.error("Failed to load leaderboard:",s),(t=s.message)!=null&&t.includes("permission")?g("Permission denied. Please check Firestore rules allow reading the leaderboardCache collection."):(i=s.message)!=null&&i.includes("index")?g("Database index required. Check browser console for the index creation link."):g("Failed to load leaderboard. Please try again.")}finally{b(!1)}},E=async()=>{if(!(n!=null&&n.uid)||!o)return;w(!0);const t=await z(o,n.uid);t.success?v(t.data):alert(t.message),w(!1)},C=t=>{c===t?N(p==="desc"?"asc":"desc"):(F(t),N("desc"))},k=[...A].sort((t,i)=>{const s=t[c]||0,x=i[c]||0;return p==="desc"?x-s:s-x}),I=t=>t===1?e("span",{className:"text-2xl",children:"\u{1F947}"}):t===2?e("span",{className:"text-2xl",children:"\u{1F948}"}):t===3?e("span",{className:"text-2xl",children:"\u{1F949}"}):a("span",{className:"text-lg font-bold text-gray-500 dark:text-gray-400",children:["#",t]}),G=t=>t>=30?e(d,{className:"text-red-500 text-xl"}):t>=14?e(d,{className:"text-orange-500"}):t>=7?e(d,{className:"text-yellow-500"}):e(d,{className:"text-gray-400"});return o?a("div",{className:"max-w-5xl mx-auto py-4",children:[e(H,{}),a("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[a("div",{children:[a("h1",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[e(D,{className:"text-yellow-500"}),"Group Leaderboard"]}),e("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Compete with your peers and climb the ranks!"})]}),e("div",{className:"flex gap-2",children:a("button",{onClick:E,disabled:y||r==="contests",className:"flex items-center gap-2 px-4 py-2 bg-brand hover:bg-brand-hover text-white rounded-lg disabled:opacity-50 transition-colors",title:r==="contests"?"Contest points refresh automatically":"",children:[e(V,{className:y?"animate-spin":""}),y?"Refreshing...":"Refresh Stats"]})})]}),a("div",{className:"flex border-b dark:border-leet-border mb-6",children:[a("button",{onClick:()=>S("overall"),className:`px-6 py-3 font-bold flex items-center gap-2 border-b-2 transition-colors ${r==="overall"?"border-brand text-brand":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[e(W,{})," Overall Progress"]}),a("button",{onClick:()=>S("contests"),className:`px-6 py-3 font-bold flex items-center gap-2 border-b-2 transition-colors ${r==="contests"?"border-brand text-brand":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[e(_,{})," ITI Contests"]})]}),r==="overall"&&e("div",{className:"flex gap-2 mb-6 bg-gray-100 dark:bg-leet-input p-1 rounded-lg w-fit",children:U.map(t=>e("button",{onClick:()=>B(t.id),className:`px-4 py-2 rounded-md font-medium transition-colors ${f===t.id?"bg-white dark:bg-leet-card text-brand shadow":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:t.label},t.id))}),u&&e("div",{className:"flex items-center justify-center py-20",children:e(q,{className:"text-4xl text-brand animate-spin"})}),m&&a("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 text-center",children:[e("p",{className:"text-red-600 dark:text-red-400",children:m}),e("button",{onClick:P,className:"mt-2 text-sm text-red-700 dark:text-red-300 underline",children:"Try Again"})]}),!u&&!m&&e("div",{className:"bg-white dark:bg-leet-card rounded-xl shadow-lg overflow-hidden",children:a("table",{className:"w-full",children:[e("thead",{className:"bg-gray-50 dark:bg-leet-input",children:a("tr",{children:[e("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Rank"}),e("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Student"}),e("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-brand",onClick:()=>C(r==="overall"?"totalPoints":"contestPoints"),children:a("div",{className:"flex items-center justify-center gap-1",children:["Points",(c==="totalPoints"||c==="contestPoints")&&(p==="desc"?e(R,{className:"text-xs"}):e(T,{className:"text-xs"}))]})}),r==="overall"?a(j,{children:[e("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider hidden md:table-cell",children:"Solved"}),e("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider hidden lg:table-cell",children:"Bonus"}),e("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-brand",onClick:()=>C("streak"),children:a("div",{className:"flex items-center justify-center gap-1",children:["Streak",c==="streak"&&(p==="desc"?e(R,{className:"text-xs"}):e(T,{className:"text-xs"}))]})})]}):e("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Contests Won"})]})}),e("tbody",{className:"divide-y divide-gray-200 dark:divide-leet-border",children:k.length===0?e("tr",{children:e("td",{colSpan:"7",className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"No students found in this group. Make sure everyone has set up their LeetCode username!"})}):k.map((t,i)=>{var L;const s=c==="totalSolved"&&p==="desc"?i+1:t.rank,x=t.id===(n==null?void 0:n.uid);return a("tr",{className:`hover:bg-gray-50 dark:hover:bg-leet-input transition-colors ${x?"bg-brand/5 dark:bg-brand/10":""}`,children:[e("td",{className:"px-4 py-4 whitespace-nowrap",children:I(s)}),e("td",{className:"px-4 py-4",children:a("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-gradient-to-br from-brand to-brand-hover rounded-full flex items-center justify-center text-white font-bold",children:(L=t.displayName)==null?void 0:L.charAt(0).toUpperCase()}),a("div",{children:[a("p",{className:`font-medium ${x?"text-brand":"dark:text-white"}`,children:[t.displayName,x&&e("span",{className:"ml-2 text-xs text-brand",children:"(You)"})]}),a("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["@",t.leetcodeUsername]})]})]})}),e("td",{className:"px-4 py-4 text-center",children:e("span",{className:"text-xl font-bold text-brand",children:r==="overall"?t.totalPoints||0:t.contestPoints||0})}),r==="overall"?a(j,{children:[e("td",{className:"px-4 py-4 text-center hidden md:table-cell",children:a("div",{className:"flex flex-col text-xs",children:[a("span",{className:"text-green-500",children:["E: ",t.easySolved||0]}),a("span",{className:"text-yellow-600",children:["M: ",t.mediumSolved||0]}),a("span",{className:"text-red-500",children:["H: ",t.hardSolved||0]})]})}),e("td",{className:"px-4 py-4 text-center hidden lg:table-cell",children:a("span",{className:"text-blue-500 font-medium",children:["+",(t.streak||0)*10]})}),e("td",{className:"px-4 py-4",children:a("div",{className:"flex items-center justify-center gap-1",children:[G(t.streak||0),e("span",{className:"font-medium dark:text-white",children:t.streak||0})]})})]}):e("td",{className:"px-4 py-4 text-center",children:e("span",{className:"text-gray-500",children:"-"})})]},t.id)})})]})}),!u&&!m&&k.length>0&&a("div",{className:"mt-6 flex flex-wrap gap-6 text-sm text-gray-500 dark:text-gray-400",children:[a("div",{className:"flex items-center gap-2",children:[e(d,{className:"text-gray-400"}),e("span",{children:"1-6 days"})]}),a("div",{className:"flex items-center gap-2",children:[e(d,{className:"text-yellow-500"}),e("span",{children:"7-13 days"})]}),a("div",{className:"flex items-center gap-2",children:[e(d,{className:"text-orange-500"}),e("span",{children:"14-29 days"})]}),a("div",{className:"flex items-center gap-2",children:[e(d,{className:"text-red-500 text-xl"}),e("span",{children:"30+ days \u{1F525}"})]})]})]}):a("div",{className:"max-w-4xl mx-auto mt-8 p-8 bg-white dark:bg-leet-card rounded-xl shadow-lg text-center",children:[e(Y,{className:"text-4xl text-yellow-500 mx-auto mb-4"}),e("h2",{className:"text-xl font-bold dark:text-white mb-2",children:"No Group Assigned"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"You need to be assigned to a group to view the leaderboard. Please contact your supervisor."})]})};export{ee as default};
