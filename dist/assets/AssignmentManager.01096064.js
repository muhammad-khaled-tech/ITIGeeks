import{r as a,b as r,j as t}from"./vendor-react.4d235dc1.js";import{u as F,A as G,q,z as L,r as E,s as m}from"./index.3ea7780e.js";import{R as A,h as b,x as M,j as O,f as R,p as U}from"./vendor-firebase.278f80a4.js";import"./vendor-ui.7a96cdac.js";const K=()=>{const{currentUser:l,userData:i,isAdmin:C}=F(),[P,D]=a.exports.useState([]),[_,u]=a.exports.useState(!0),[g,p]=a.exports.useState(!1),[h,x]=a.exports.useState(""),[f,k]=a.exports.useState(""),[N,w]=a.exports.useState(""),[y,j]=a.exports.useState((i==null?void 0:i.groupId)||"All"),[d,v]=a.exports.useState(""),[n,c]=a.exports.useState([]),S=async()=>{u(!0);try{let e=A(b(m,"assignments"),M("deadline","desc"));C||(e=A(b(m,"assignments"),O("creatorId","==",l.uid)));const s=await R(e);D(s.docs.map(o=>({id:o.id,...o.data()})))}catch(e){console.error(e)}finally{u(!1)}};a.exports.useEffect(()=>{l&&S()},[l]);const T=()=>{if(!d.trim())return;const e=d.trim().toLowerCase().replace(/\s+/g,"-");c([...n,{slug:e,title:d,required:!0}]),v("")},I=e=>{c(n.filter((s,o)=>o!==e))};return r("div",{className:"max-w-6xl mx-auto p-6",children:[r("div",{className:"flex justify-between items-center mb-8",children:[r("h1",{className:"text-3xl font-bold flex items-center gap-2 dark:text-white",children:[t(G,{className:"text-brand"})," Assignment Manager"]}),r("button",{onClick:()=>p(!g),className:"bg-brand hover:bg-brand-hover text-white px-4 py-2 rounded flex items-center gap-2",children:[t(q,{})," Create Assignment"]})]}),g&&r("div",{className:"bg-white dark:bg-leet-card p-6 rounded-lg shadow mb-8 border border-gray-200 dark:border-leet-border",children:[t("h3",{className:"text-xl font-bold mb-4 dark:text-white",children:"New Assignment"}),r("form",{onSubmit:async e=>{e.preventDefault();try{await U(b(m,"assignments"),{title:h,description:f,deadline:new Date(N).toISOString(),targetGroup:y,creatorId:l.uid,problems:n,createdAt:new Date().toISOString()}),alert("Assignment Created!"),p(!1),x(""),k(""),w(""),c([]),S()}catch(s){console.error(s),alert("Error creating assignment")}},className:"space-y-4",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r("div",{children:[t("label",{className:"block text-sm font-bold mb-1 dark:text-gray-300",children:"Title"}),t("input",{type:"text",required:!0,value:h,onChange:e=>x(e.target.value),className:"w-full p-2 border rounded dark:bg-leet-input dark:text-white dark:border-leet-border"})]}),r("div",{children:[t("label",{className:"block text-sm font-bold mb-1 dark:text-gray-300",children:"Deadline"}),t("input",{type:"datetime-local",required:!0,value:N,onChange:e=>w(e.target.value),className:"w-full p-2 border rounded dark:bg-leet-input dark:text-white dark:border-leet-border"})]})]}),r("div",{children:[t("label",{className:"block text-sm font-bold mb-1 dark:text-gray-300",children:"Description"}),t("textarea",{value:f,onChange:e=>k(e.target.value),className:"w-full p-2 border rounded dark:bg-leet-input dark:text-white dark:border-leet-border",rows:"3"})]}),r("div",{children:[t("label",{className:"block text-sm font-bold mb-1 dark:text-gray-300",children:"Target Group"}),t("input",{type:"text",value:y,onChange:e=>j(e.target.value),className:"w-full p-2 border rounded dark:bg-leet-input dark:text-white dark:border-leet-border",placeholder:"e.g. Group A or All"})]}),r("div",{className:"border-t dark:border-leet-border pt-4",children:[t("label",{className:"block text-sm font-bold mb-2 dark:text-gray-300",children:"Problems"}),r("div",{className:"flex gap-2 mb-2",children:[t("input",{type:"text",value:d,onChange:e=>v(e.target.value),placeholder:"Problem Title or Slug (e.g. Two Sum)",className:"flex-grow p-2 border rounded dark:bg-leet-input dark:text-white dark:border-leet-border"}),t("button",{type:"button",onClick:T,className:"bg-gray-200 dark:bg-gray-700 px-4 rounded",children:"Add"})]}),t("ul",{className:"space-y-2",children:n.map((e,s)=>r("li",{className:"flex justify-between items-center bg-gray-50 dark:bg-leet-input p-2 rounded",children:[r("span",{className:"dark:text-gray-300",children:[e.title," (",e.slug,")"]}),t("button",{type:"button",onClick:()=>I(s),className:"text-red-500",children:t(L,{})})]},s))})]}),t("div",{className:"flex justify-end pt-4",children:t("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded font-bold",children:"Publish Assignment"})})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(e=>r("div",{className:"bg-white dark:bg-leet-card p-4 rounded shadow border-l-4 border-blue-500",children:[t("h3",{className:"font-bold text-lg dark:text-white",children:e.title}),r("p",{className:"text-sm text-gray-500 mb-2",children:["Deadline: ",new Date(e.deadline).toLocaleDateString()]}),r("p",{className:"text-sm dark:text-gray-400 mb-4",children:[e.problems.length," Problems"]}),r("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[r("span",{children:["Group: ",e.targetGroup]}),r("button",{className:"text-blue-500 hover:underline flex items-center gap-1",children:[t(E,{})," View Progress"]})]})]},e.id))})]})};export{K as default};
