import{b as s,j as e,L as w,r as x}from"./vendor-react.4d235dc1.js";import{B as y,C as v,u as N,A as k,s as A}from"./index.87213db3.js";import{R as D,h as j,j as L,x as $,f as M}from"./vendor-firebase.278f80a4.js";import"./vendor-ui.7a96cdac.js";const S=({assignment:t,progress:i,isStudent:m=!0})=>{const{title:g,deadline:l,problems:h,id:r}=t,a=h.length,d=i||0,n=Math.round(d/a*100)||0,o=new Date(l),c=new Date>o&&n<100,f=()=>{const p=new Date,u=o-p;if(u<0)return"Ended";const b=Math.floor(u/(1e3*60*60*24));return b>0?`${b} days left`:`${Math.floor(u/(1e3*60*60))} hours left`};return s("div",{className:`bg-white dark:bg-leet-card rounded-lg shadow-md p-4 border-l-4 ${c?"border-red-500":"border-brand"} hover:shadow-lg transition-shadow`,children:[s("div",{className:"flex justify-between items-start mb-2",children:[e("h3",{className:"font-bold text-lg dark:text-white",children:g}),c&&e(y,{className:"text-red-500",title:"Overdue"})]}),s("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4 flex items-center gap-2",children:[e(v,{}),s("span",{className:c?"text-red-500 font-bold":"",children:[new Date(l).toLocaleDateString()," (",f(),")"]})]}),s("div",{className:"mb-4",children:[s("div",{className:"flex justify-between text-xs mb-1 dark:text-gray-300",children:[e("span",{children:"Progress"}),s("span",{children:[d,"/",a," Problems"]})]}),e("div",{className:"w-full bg-gray-200 dark:bg-leet-input rounded-full h-2.5",children:e("div",{className:`h-2.5 rounded-full ${n===100?"bg-green-500":c?"bg-red-500":"bg-brand"}`,style:{width:`${n}%`}})})]}),m?e(w,{to:`/assignments/${r}`,className:"block w-full text-center bg-gray-100 dark:bg-leet-input hover:bg-gray-200 dark:hover:bg-gray-700 text-brand dark:text-brand-dark font-medium py-2 rounded transition-colors",children:"View Details"}):s("div",{className:"text-center text-sm text-gray-500",children:["Target: ",t.targetGroup]})]})},O=()=>{const{userData:t}=N(),[i,m]=x.exports.useState([]),[g,l]=x.exports.useState(!0);x.exports.useEffect(()=>{(async()=>{if(!!t){l(!0);try{const a=D(j(A,"assignments"),L("targetGroup","in",[t.groupId||"All","All"]),$("deadline","asc")),d=await M(a);m(d.docs.map(n=>({id:n.id,...n.data()})))}catch(a){console.error(a)}finally{l(!1)}}})()},[t]);const h=r=>{if(!(t!=null&&t.problems))return 0;let a=0;return r.forEach(d=>{t.problems.some(o=>o.title===d.title&&o.status==="Done")&&a++}),a};return g?e("div",{className:"p-10 text-center dark:text-white",children:"Loading Assignments..."}):s("div",{className:"max-w-6xl mx-auto p-6",children:[s("h1",{className:"text-3xl font-bold mb-8 flex items-center gap-2 dark:text-white",children:[e(k,{className:"text-brand"})," My Assignments"]}),i.length===0?e("div",{className:"text-center py-10 bg-white dark:bg-leet-card rounded shadow",children:e("p",{className:"text-gray-500 dark:text-gray-400",children:"No active assignments."})}):e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(r=>e(S,{assignment:r,progress:h(r.problems)},r.id))})]})};export{O as default};
