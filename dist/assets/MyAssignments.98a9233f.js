import{b as a,j as e,L as w,r as b}from"./vendor-react.4d235dc1.js";import{B as y,C as v,u as N,A as k,s as A}from"./index.84d46f47.js";import{R as D,h as L,j,x as S,f as $}from"./vendor-firebase.278f80a4.js";import"./vendor-ui.7a96cdac.js";const C=({assignment:t,progress:i,isStudent:m=!0})=>{const{title:g,deadline:d,problems:h,id:n}=t,r=h.length,s=i||0,l=Math.round(s/r*100)||0,o=new Date(d),c=new Date>o&&l<100,x=()=>{const p=new Date,u=o-p;if(u<0)return"Ended";const f=Math.floor(u/(1e3*60*60*24));return f>0?`${f} days left`:`${Math.floor(u/(1e3*60*60))} hours left`};return a("div",{className:`bg-white dark:bg-leet-card rounded-lg shadow-md p-4 border-l-4 ${c?"border-red-500":"border-brand"} hover:shadow-lg transition-shadow`,children:[a("div",{className:"flex justify-between items-start mb-2",children:[e("h3",{className:"font-bold text-lg dark:text-white",children:g}),c&&e(y,{className:"text-red-500",title:"Overdue"})]}),a("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4 flex items-center gap-2",children:[e(v,{}),a("span",{className:c?"text-red-500 font-bold":"",children:[new Date(d).toLocaleDateString()," (",x(),")"]})]}),a("div",{className:"mb-4",children:[a("div",{className:"flex justify-between text-xs mb-1 dark:text-gray-300",children:[e("span",{children:"Progress"}),a("span",{children:[s,"/",r," Problems"]})]}),e("div",{className:"w-full bg-gray-200 dark:bg-leet-input rounded-full h-2.5",children:e("div",{className:`h-2.5 rounded-full ${l===100?"bg-green-500":c?"bg-red-500":"bg-brand"}`,style:{width:`${l}%`}})})]}),m?e(w,{to:`/assignments/${n}`,className:"block w-full text-center bg-gray-100 dark:bg-leet-input hover:bg-gray-200 dark:hover:bg-gray-700 text-brand dark:text-brand-dark font-medium py-2 rounded transition-colors",children:"View Details"}):a("div",{className:"text-center text-sm text-gray-500",children:["Target: ",t.targetGroup]})]})},O=()=>{const{userData:t}=N(),[i,m]=b.exports.useState([]),[g,d]=b.exports.useState(!0);b.exports.useEffect(()=>{(async()=>{if(!!t){d(!0);try{const r=D(L(A,"assignments"),j("targetGroup","in",[t.groupId||"All","All"]),S("deadline","asc")),s=await $(r);m(s.docs.map(l=>({id:l.id,...l.data()})))}catch(r){console.error(r)}finally{d(!1)}}})()},[t]);const h=n=>{if(!(t!=null&&t.problems))return 0;new Set(t.problems.filter(s=>s.status==="Done").map(s=>s.title.toLowerCase().replace(/\s+/g,"-")));let r=0;return n.forEach(s=>{t.problems.some(o=>o.title===s.title&&o.status==="Done")&&r++}),r};return g?e("div",{className:"p-10 text-center dark:text-white",children:"Loading Assignments..."}):a("div",{className:"max-w-6xl mx-auto p-6",children:[a("h1",{className:"text-3xl font-bold mb-8 flex items-center gap-2 dark:text-white",children:[e(k,{className:"text-brand"})," My Assignments"]}),i.length===0?e("div",{className:"text-center py-10 bg-white dark:bg-leet-card rounded shadow",children:e("p",{className:"text-gray-500 dark:text-gray-400",children:"No active assignments."})}):e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(n=>e(C,{assignment:n,progress:h(n.problems)},n.id))})]})};export{O as default};
