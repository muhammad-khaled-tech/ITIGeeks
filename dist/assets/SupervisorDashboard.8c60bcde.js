import{u as R,r as i,j as e,b as a}from"./vendor-react.beb85f38.js";import{u as U,C as P,z,D as B,E as G,G as H,B as S}from"./index.d2a1d721.js";import{R as I,h as D,j as M,f as O,p as _}from"./vendor-firebase.278f80a4.js";import"./vendor-ui.24a42a1c.js";const W=()=>{const{userData:l,loading:m}=U(),x=R(),[A,C]=i.exports.useState([]),[j,E]=i.exports.useState(!0),[g,L]=i.exports.useState(""),[o,b]=i.exports.useState(null),[h,f]=i.exports.useState(""),[p,y]=i.exports.useState(""),[u,N]=i.exports.useState("");i.exports.useEffect(()=>{!m&&(l==null?void 0:l.role)!=="supervisor"&&x("/")},[l,m,x]),i.exports.useEffect(()=>{const t=async()=>{try{const s=I(D(S,"users"),M("role","==","student")),d=(await O(s)).docs.map(n=>({id:n.id,...n.data()}));C(d)}catch(s){console.error("Error fetching students:",s)}finally{E(!1)}};(l==null?void 0:l.role)==="supervisor"&&t()},[l]);const T=async t=>{if(t.preventDefault(),!(!h||!p||!u))try{const s=u.split(",").map(r=>r.trim()).filter(r=>r);await _(D(S,"assignments"),{title:h,deadline:p,problems:s.map(r=>({titleSlug:r})),createdBy:l.uid,createdAt:new Date().toISOString()}),alert("Assignment Created!"),f(""),y(""),N("")}catch(s){console.error("Error creating assignment:",s),alert("Failed to create assignment.")}},v=A.filter(t=>(t.displayName||t.email||"").toLowerCase().includes(g.toLowerCase()));return m||j?e("div",{className:"p-8 text-center",children:"Loading Dashboard..."}):a("div",{className:"space-y-8",children:[a("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white flex items-center gap-3",children:[e(P,{className:"text-brand"})," Supervisor Dashboard"]}),a("div",{className:"bg-white dark:bg-leet-card p-6 rounded-lg shadow-md",children:[a("h2",{className:"text-xl font-bold mb-4 dark:text-white flex items-center gap-2",children:[e(z,{className:"text-green-500"})," Create Assignment"]}),a("form",{onSubmit:T,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e("input",{type:"text",placeholder:"Assignment Title",value:h,onChange:t=>f(t.target.value),className:"p-2 border rounded dark:bg-leet-input dark:border-leet-border dark:text-white",required:!0}),e("input",{type:"date",value:p,onChange:t=>y(t.target.value),className:"p-2 border rounded dark:bg-leet-input dark:border-leet-border dark:text-white",required:!0}),e("textarea",{placeholder:"Problem Slugs (comma separated, e.g. two-sum, valid-anagram)",value:u,onChange:t=>N(t.target.value),className:"p-2 border rounded dark:bg-leet-input dark:border-leet-border dark:text-white md:col-span-2",rows:"3",required:!0}),e("button",{type:"submit",className:"bg-brand hover:bg-brand-hover text-white py-2 px-4 rounded md:col-span-2 font-bold",children:"Publish Assignment"})]})]}),a("div",{className:"bg-white dark:bg-leet-card p-6 rounded-lg shadow-md",children:[a("div",{className:"flex justify-between items-center mb-4",children:[a("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[e(B,{className:"text-blue-500"})," Student Progress"]}),a("div",{className:"relative",children:[e(G,{className:"absolute left-3 top-3 text-gray-400"}),e("input",{type:"text",placeholder:"Search students...",value:g,onChange:t=>L(t.target.value),className:"pl-10 p-2 border rounded dark:bg-leet-input dark:border-leet-border dark:text-white"})]})]}),e("div",{className:"overflow-x-auto",children:a("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-leet-border",children:[e("thead",{className:"bg-gray-50 dark:bg-leet-input",children:a("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-leet-sub uppercase tracking-wider",children:"Student"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-leet-sub uppercase tracking-wider",children:"Solved (Total)"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-leet-sub uppercase tracking-wider",children:"Easy / Med / Hard"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-leet-sub uppercase tracking-wider",children:"Last Active"}),e("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-leet-sub uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white dark:bg-leet-card divide-y divide-gray-200 dark:divide-leet-border",children:v.length===0?e("tr",{children:e("td",{colSpan:"5",className:"text-center py-4 text-gray-500",children:"No students found."})}):v.map(t=>{var w,k;const r=(t.problems||[]).filter(c=>c.status==="Done"),d=r.filter(c=>c.difficulty==="Easy").length,n=r.filter(c=>c.difficulty==="Medium").length,q=r.filter(c=>c.difficulty==="Hard").length,F=((w=t.aiUsage)==null?void 0:w.date)||"N/A";return a("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"flex items-center",children:[e("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 font-bold overflow-hidden",children:t.photoURL?e("img",{src:t.photoURL,alt:"",className:"h-full w-full object-cover"}):((k=t.displayName)==null?void 0:k[0])||"S"}),a("div",{className:"ml-4",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.displayName||"Unknown"}),e("div",{className:"text-sm text-gray-500",children:t.email})]})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white font-bold",children:r.length}),a("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[e("span",{className:"text-green-600 font-bold",children:d})," / ",e("span",{className:"text-yellow-600 font-bold",children:n})," / ",e("span",{className:"text-red-600 font-bold",children:q})]}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:F}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a("button",{onClick:()=>b(t),className:"text-brand hover:text-brand-hover flex items-center gap-1 ml-auto",children:[e(H,{})," Details"]})})]},t.id)})})]})})]}),o&&e("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm p-4",children:a("div",{className:"bg-white dark:bg-leet-card w-full max-w-2xl rounded-lg shadow-xl overflow-hidden max-h-[90vh] overflow-y-auto",children:[a("div",{className:"p-6 border-b dark:border-leet-border flex justify-between items-center",children:[a("h3",{className:"text-xl font-bold dark:text-white",children:[o.displayName,"'s Analysis"]}),e("button",{onClick:()=>b(null),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400",children:"Close"})]}),a("div",{className:"p-6 space-y-6",children:[a("div",{children:[e("h4",{className:"font-bold text-lg mb-3 dark:text-gray-200",children:"Recent Activity"}),a("div",{className:"space-y-2",children:[(o.problems||[]).filter(t=>t.status==="Done").sort((t,s)=>new Date(s.completedDate||0)-new Date(t.completedDate||0)).slice(0,5).map((t,s)=>a("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-leet-input p-3 rounded",children:[e("span",{className:"font-medium dark:text-white",children:t.title||t.name}),e("span",{className:"text-xs text-gray-500",children:new Date(t.completedDate).toLocaleDateString()})]},s)),!(o.problems||[]).some(t=>t.status==="Done")&&e("p",{className:"text-gray-500",children:"No recent activity."})]})]}),a("div",{children:[e("h4",{className:"font-bold text-lg mb-3 dark:text-gray-200",children:"Technique Analysis"}),e("div",{className:"flex flex-wrap gap-2",children:(()=>{const t={};(o.problems||[]).forEach(r=>{r.status==="Done"&&r.type&&r.type.split(",").forEach(d=>{const n=d.trim();n&&(t[n]=(t[n]||0)+1)})});const s=Object.entries(t).sort((r,d)=>d[1]-r[1]).slice(0,10);return s.length===0?e("p",{className:"text-gray-500",children:"No data available."}):s.map(([r,d])=>a("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800",children:[r," (",d,")"]},r))})()})]})]})]})})]})};export{W as default};
